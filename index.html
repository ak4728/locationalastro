<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astrocartography Map Generator</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Astrocartography Map</h1>
            <p>Discover where the planets align for you around the world</p>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <h2>Birth Information</h2>
                
                <div class="form-group">
                    <label>üìÖ Birth Date</label>
                    <input type="date" id="birthDate" value="1986-07-31" required>
                </div>

                <div class="form-group">
                    <label>‚è∞ Birth Time (Local)</label>
                    <input type="time" id="birthTime" value="13:30" step="1" required>
                </div>

                <div class="form-group">
                    <label>üìç Birth Location</label>
                    <div id="locationGeocoderContainer"></div>
                    <input type="text" id="birthLocation" value="Istanbul, Turkey" style="display: none;">
                </div>

                <div class="form-group">
                    <label>üåç Coordinate System</label>
                    <select id="coordinateSystem" class="form-select">
                        <option value="mundo">Mundo (Local Space)</option>
                        <option value="zodio" selected>Zodio (In Zodiac)</option>
                    </select>
                    <small style="color: rgba(255,255,255,0.6); font-size: 0.85rem; margin-top: 5px; display: block;">Zodio matches most astrology sites like Astro-Seek</small>
                </div>

                <div class="form-group" id="coordsGroup" style="display: none;">
                    <label>Coordinates (auto-detected)</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="number" id="birthLat" step="0.0001" placeholder="Latitude" readonly style="opacity: 0.7;">
                        <input type="number" id="birthLon" step="0.0001" placeholder="Longitude" readonly style="opacity: 0.7;">
                    </div>
                </div>

                <div class="form-group" id="timezoneGroup" style="display: none;">
                    <label>Timezone (auto-detected)</label>
                    <input type="text" id="tzDisplay" readonly style="opacity: 0.7;">
                    <input type="hidden" id="tzOffset" value="3">
                    <label style="margin-top: 8px; display: flex; align-items: center; font-size: 0.9rem;">
                        <input type="checkbox" id="lockTimezone" style="margin-right: 8px;"> Lock timezone (disable auto-detection)
                    </label>
                </div>

                <button class="btn" id="generateBtn">Generate Map</button>
                <button class="btn" id="shareBtn" style="margin-top: 10px; background: linear-gradient(45deg, #28a745 0%, #20c997 100%);">Share Map</button>
                
                <button type="button" id="toggleTechnical" style="margin-top: 10px; padding: 8px 12px; background: transparent; border: 1px solid rgba(255,255,255,0.3); border-radius: 8px; color: rgba(255,255,255,0.7); cursor: pointer; font-size: 0.85rem; width: 100%;">Show Technical Details</button>

                <div class="legend" id="legend" style="display: none;">
                    <h3>Planetary Lines</h3>
                    <div class="legend-grid">
                        <div class="line-type">
                            <strong>AC</strong>
                            <span>Ascendant Rising Line</span>
                        </div>
                        <div class="line-type">
                            <strong>DC</strong>
                            <span>Descendant Setting Line</span>
                        </div>
                        <div class="line-type">
                            <strong>MC</strong>
                            <span>Midheaven Culmination</span>
                        </div>
                        <div class="line-type">
                            <strong>IC</strong>
                            <span>Imum Coeli Lower Culmination</span>
                        </div>
                    </div>
                    
                    <div class="planet-list" id="planetList"></div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255,165,0,0.1); border: 1px solid rgba(255,165,0,0.3); border-radius: 8px; font-size: 0.8rem; color: rgba(255,255,255,0.8);">
                        <strong>‚ö†Ô∏è Accuracy Note:</strong> Planet positions use approximate calculations (mean longitude + Œ≤=0). For professional accuracy matching Astro-Seek exactly, Swiss Ephemeris would be needed. The Zodio coordinate system provides closer alignment with commercial astrology software.
                    </div>
                </div>
            </div>

            <div class="map-container">
                <div id="map"></div>
                
                <div class="info-box" id="infoBox" style="display: none;">
                    <h4>About Your Astrocartography Map</h4>
                    <p>
                        Your astrocartography map shows planetary lines across the world. Each line represents 
                        where a planet was on a specific angle (AC/DC/MC/IC) at your time of birth. Locations near these 
                        lines may have special significance for you, influencing different life areas depending on the 
                        planet and angle. Hover over any line to see details about that planetary influence.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/astronomy-engine@2.1.19/astronomy.browser.min.js"></script>
    <script src="script.js"></script>
</body>
</html>